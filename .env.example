# ============================================
# Supabase Configuration
# ============================================
# Production (default)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# ============================================
# Local Supabase Development
# ============================================
# Uncomment these to use local Supabase (run `supabase start` first)
# The keys below are printed when you run `supabase start`
# NEXT_PUBLIC_SUPABASE_URL=http://127.0.0.1:54321
# NEXT_PUBLIC_SUPABASE_ANON_KEY=<local-anon-key-from-supabase-start>
# SUPABASE_SERVICE_ROLE_KEY=<local-service-key-from-supabase-start>
#
# Optional: Use production storage for images while testing with local DB
# NEXT_PUBLIC_SUPABASE_STORAGE_URL=https://your-project.supabase.co
#
# Local Supabase workflow:
#   1. npm run db:local:seed   # Pull production data subset (one-time)
#   2. npm run db:local:start  # Start Docker containers
#   3. npm run db:local:reset  # Apply migrations + seed data
#   4. Edit supabase/functions/search_functions.sql
#   5. supabase db push --local  # Test changes locally
#   6. npm run db:push         # Deploy to production when ready
#   7. npm run db:local:stop   # Stop containers when done
#
# Local Studio: http://127.0.0.1:54323

# Database Connection (CRITICAL: Use pooler for production)
# Transaction Pooler (Port 6543) - REQUIRED for serverless/production
# - Supports ~2000 connections
# - Connection pooling prevents exhaustion
# - Use this for Vercel/production deployments
# Direct Connection (Port 5432) - Only for local development/migrations
# - Limited to ~100 connections
# - Use for running migrations or local debugging only
DATABASE_URL=postgresql://postgres.your-project:password@aws-0-us-west-2.pooler.supabase.com:6543/postgres

# OpenAI API (for image filtering Phase 3 + CLIP embeddings Phase 4)
OPENAI_API_KEY=sk-proj-your-key-here

# Google APIs (for discovery)
GOOGLE_SEARCH_ENGINE_ID=your-search-engine-id
GOOGLE_CUSTOM_SEARCH_API_KEY=your-api-key
GOOGLE_PLACES_API_KEY=your-places-api-key

# ScrapingDog (Primary - 5x cheaper than Apify for profile scraping)
# Get API key from: https://www.scrapingdog.com/
# Standard tier: $90/mo for 1M credits (~66k profiles)
SCRAPINGDOG_API_KEY=your_scrapingdog_api_key

# Apify (Fallback for Instagram scraping)
# PAID account - used for heavy pipeline scraping (hashtag mining, follower mining, bulk scraper)
APIFY_API_TOKEN=apify_api_your_token_here
# FREE account ($5/mo credit) - used for lightweight operations
# Falls back to APIFY_API_TOKEN if not set
APIFY_API_TOKEN_FREE=apify_api_your_free_token_here

# DataForSEO (Phase 0 - completed, can be removed if not re-running)
DATAFORSEO_LOGIN=your-email
DATAFORSEO_PASSWORD=your-password

# Tavily API (for discovery)
TAAVILY_API=tvly-prod-your-key-here

# Phase 5: Search Flow Configuration
NEXT_PUBLIC_MOCK_EMBEDDINGS=true  # Use synthetic embeddings for testing (set to false when Phase 3/4 complete)

# ============================================
# CLIP Embedding - Hybrid Configuration
# ============================================

# Local GPU Service (Primary)
LOCAL_CLIP_URL=https://clip.inkdex.io  # Local A2000 GPU endpoint
CLIP_API_KEY=your-api-key-here   # API key for authentication (optional)
LOCAL_CLIP_TIMEOUT=5000  # Timeout in milliseconds (5 seconds)

# Windows GPU Service (Secondary Local GPU - for parallel processing)
WINDOWS_GPU_URL=http://10.2.0.10:5000  # Windows RTX 4080 GPU listener endpoint (or https://clip-win.inkdex.io via Cloudflare Tunnel)
WINDOWS_GPU_API_KEY=your-secret-api-key-here  # API key for Windows GPU authentication

# Modal.com Fallback (Tertiary)
MODAL_FUNCTION_URL=https://yourusername--tattoo-clip-embeddings.modal.run  # Modal.com endpoint

# Hybrid Client Behavior
PREFER_LOCAL_CLIP=true           # Try local GPU first (set to false to use Modal only)
ENABLE_MODAL_FALLBACK=true       # Use Modal if local fails (set to false for local-only mode)

# Warmup Configuration (disable for local GPU - no cold starts)
NEXT_PUBLIC_ENABLE_WARMUP=false  # Pre-warm Modal container (disable when using local GPU)

# ============================================
# Instagram OAuth via Facebook (Phase 2)
# ============================================
# Note: These are Facebook App credentials, not Instagram directly
# Instagram Basic Display API was sunset Dec 4, 2024
# We use Instagram Graph API via Facebook Login
# Artists must have Instagram Business or Creator account (not Personal)
INSTAGRAM_CLIENT_ID=your_facebook_app_id
INSTAGRAM_CLIENT_SECRET=your_facebook_app_secret
NEXT_PUBLIC_INSTAGRAM_CLIENT_ID=your_facebook_app_id

# ============================================
# Cloudflare Turnstile (Bot Protection - Phase 4)
# ============================================
# Used for progressive captcha on /add-artist recommendation form
# Get keys from: https://dash.cloudflare.com/
NEXT_PUBLIC_TURNSTILE_SITE_KEY=0x4AAAAAAAxxxxxxxxxxxxxxxxxx
TURNSTILE_SECRET_KEY=0x4AAAAAAAxxxxxxxxxxxxxxxxxx

# ============================================
# Google Analytics 4 (Phase 8 - Cookie Consent)
# ============================================
# Get measurement ID from: https://analytics.google.com/
# Format: G-XXXXXXXXXX
# Only loads if user consents to analytics cookies
NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX

# ============================================
# Google Ads Conversion Tracking
# ============================================
# Get from: Google Ads → Tools → Conversions → Create → Website → Manual setup
# 1. Create "Artist Claim" conversion (value: $1.00)
# 2. Create "Search Completed" conversion (value: $0.10)
# 3. Copy the Conversion ID (AW-XXXXXXXXXX) and labels
NEXT_PUBLIC_GOOGLE_ADS_ID=AW-XXXXXXXXXX
# Conversion labels (the part after the slash in send_to)
NEXT_PUBLIC_GADS_CLAIM_LABEL=AbCdEfG123
NEXT_PUBLIC_GADS_SEARCH_LABEL=XyZaBc456

# Development
NODE_ENV=development
# Production URL - use http://localhost:3000 for local development
# Used for OAuth redirect URI: {NEXT_PUBLIC_APP_URL}/auth/callback
NEXT_PUBLIC_APP_URL=https://www.inkdex.io

# ============================================
# Resend Email Service (Phase 10)
# ============================================
# Get API key from: https://resend.com/api-keys
# Free tier: 3,000 emails/month, 100/day
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================
# Redis - Rate Limiting & Analytics (Phase 13)
# ============================================
# Railway Redis URL for distributed rate limiting, session management, and analytics deduplication
# Format: redis://default:password@hostname:port
# Get from: Railway.app dashboard -> Redis service -> Connect tab
# Used for:
# - API rate limiting across serverless instances
# - Analytics event deduplication (5-min window)
# - Distributed locks for Instagram token refresh
REDIS_URL=redis://default:password@redis.railway.internal:6379

# ============================================
# Security & Cron Configuration
# ============================================

# JWT Secret (REQUIRED FOR PRODUCTION)
# Used to sign tokens for Stripe checkout return URLs
# Generate a secure random secret:
#   openssl rand -base64 32
# Set this in Vercel environment variables
JWT_SECRET=your-random-32-char-secret-here

# Cron Job Authentication (REQUIRED FOR PRODUCTION)
# Used to protect /api/cron/sync-instagram endpoint
# Generate a secure random secret:
#   openssl rand -base64 32
# Set this in Vercel environment variables
# Without this, auto-sync for Pro artists will NOT work in production
CRON_SECRET=your-random-32-char-secret-here

# Admin Panel Access
# Comma-separated list of whitelisted admin emails
# Only these emails can access /admin routes
ADMIN_EMAIL_WHITELIST=your-email@example.com,another-admin@example.com

# ============================================
# Stripe - Subscription Payments (Phase 9)
# ============================================
# Get keys from: https://dashboard.stripe.com/test/apikeys
# Products/Prices: https://dashboard.stripe.com/test/products
# Webhook secret: https://dashboard.stripe.com/test/webhooks
STRIPE_SECRET_KEY=sk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Stripe Price IDs (create in Stripe Dashboard → Products)
# Monthly: $15/month recurring
# Yearly: $150/year recurring
STRIPE_PRICE_MONTHLY=price_xxxxxxxxxxxxxxxxxxxxx
STRIPE_PRICE_YEARLY=price_xxxxxxxxxxxxxxxxxxxxx

# ============================================
# IndexNow - Search Engine Notifications (SEO)
# ============================================
# Notifies Bing and Yandex when content changes
# Generate a UUID: uuidgen | tr '[:upper:]' '[:lower:]'
# Also create public/{key}.txt with the same key
INDEXNOW_KEY=your-uuid-key-here

# ============================================
# IFTTT - Marketing Outreach (Phase: Marketing)
# ============================================
# Used to send outreach posts to Buffer for social media scheduling
# Get webhook key from: https://ifttt.com/maker_webhooks/settings
# Pro tier ($4/mo) required for JSON payload support
IFTTT_WEBHOOK_KEY=your-ifttt-webhook-key-here
IFTTT_EVENT_NAME=inkdex_buffer_post

# ============================================
# Airtable - Marketing Automation
# ============================================
# Used for flexible marketing workflow management
# Team tier ($20/mo) recommended for 100k API calls/month
# Get credentials from: https://airtable.com/create/tokens
# Required scopes: data.records:read, data.records:write, schema.bases:read
AIRTABLE_PAT=patXXXXXXXXXXXXXXXX
AIRTABLE_BASE_ID=appXXXXXXXXXXXXXX
AIRTABLE_OUTREACH_TABLE_ID=tblXXXXXXXXXXXXXX
